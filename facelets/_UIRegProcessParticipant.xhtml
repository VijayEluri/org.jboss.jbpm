<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<div
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:t="http://myfaces.apache.org/tomahawk"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:fc="http://xmlns.idega.com/com.idega.facelets"
        xmlns:l="http://xmlns.idega.com/com.idega.block.login"
>

    <h:form>
        <t:saveState id="storeRegProcessParticipantBean" value="#{regProcessParticipantBean}"/>
        <t:saveState id="storeRegProcessParticipantBean" value="#{regProcessParticipantBean.tokenId}"/>
        
        <h1>Participate in process #{regProcessParticipantBean.processName}</h1>
        
        <t:div rendered="#{regProcessParticipantBean.loggedIn}">
            
            You're logged in the system, click <h:commandLink value="here" action="#{regProcessParticipantBean.loginSuccess}" /> to proceed
        </t:div>
        
        <t:div rendered="#{not regProcessParticipantBean.loggedIn}">
        
            <t:inputHidden id="viewDisplayed" value="#{regProcessParticipantBean.viewDisplayed}" forceId="true" />
            <fc:addResource resourcePath="#{web2bean.bundleURIToJQueryLib}" />
            <script type="text/javascript">
	            <!--
	            jQuery(document).ready(function(){
	            
	                var viewDisplayed = jQuery('#viewDisplayed').val();
	                
	                if(viewDisplayed != null && viewDisplayed != "") {
	                     
	                    jQuery(viewDisplayed).show();
	                }
	            });
	            //-->
            </script>
        
	        <t:div rendered="#{regProcessParticipantBean.afterRegSuccess}" styleClass="loginText">
	            You may <a href="#" onclick="jQuery('.registerForm').hide(); jQuery('.loginForm').show('fast'); jQuery('#viewDisplayed').val('.loginForm');" class="loginLink">login</a> now with the registered login name.
	        </t:div>     
	        <t:div rendered="#{not regProcessParticipantBean.afterRegSuccess}" styleClass="loginText">
	            <a href="#" onclick="jQuery('.registerForm').hide(); jQuery('.loginForm').show('fast'); jQuery('#viewDisplayed').val('.loginForm');" class="loginLink">Login</a> if you already have an account.     
	        </t:div>
	        
	        <t:div rendered="#{not regProcessParticipantBean.afterRegSuccess}" styleClass="registerText">
	            <a href="#" onclick="jQuery('.loginForm').hide(); jQuery('.registerForm').show('fast'); jQuery('#viewDisplayed').val('.registerForm');" class="registerLink">Register</a> otherwise.
	        </t:div>
	        
	        <div class="loginForm" style="display: none;">
	            <l:login generateContainingForm="false" />
	        </div>
	        
	        <t:div rendered="#{not regProcessParticipantBean.afterRegSuccess}" styleClass="registerForm" style="display: none;">
	            <l:register generateContainingForm="false" displayCloseButton="false" registerListener="#{regProcessParticipantBean}" />
	        </t:div>
        </t:div>
    </h:form>
</div>